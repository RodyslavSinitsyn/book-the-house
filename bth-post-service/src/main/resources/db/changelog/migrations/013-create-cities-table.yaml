databaseChangeLog:
  - changeSet:
      id: 13
      author: rsinitsyn
      comment: Creates 'cities' table
      labels: geo
      runAlways: false
      runOnChange: false
      preConditions:
        - onFail: HALT
          not:
            tableExists:
              tableName: cities
      rollback:
        - dropTable:
            tableName: cities
        - dropSequence:
            sequenceName: cities_id_seq
      changes:
        - sql:
            "CREATE TABLE public.cities
             (
                 id           bigint                                                                                 NOT NULL,
                 name         character varying(255)                                                                 NOT NULL,
                 state_id     bigint                                                                                 NOT NULL,
                 state_code   character varying(255)                                                                 NOT NULL,
                 country_id   bigint                                                                                 NOT NULL,
                 country_code character varying(2)                                                                           NOT NULL,
                 latitude     numeric(10, 8)                                                                         NOT NULL,
                 longitude    numeric(11, 8)                                                                         NOT NULL,
                 created_at   timestamp without time zone DEFAULT '2014-01-01 12:01:01'::timestamp without time zone NOT NULL,
                 updated_at   timestamp without time zone DEFAULT CURRENT_TIMESTAMP                                  NOT NULL,
                 flag         smallint                    DEFAULT 1                                                  NOT NULL,
                 wiki_data_id character varying(255)
             );
             ALTER TABLE public.cities
                 ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
                     SEQUENCE NAME public.cities_id_seq
                     START WITH 1
                     INCREMENT BY 1
                     NO MINVALUE
                     NO MAXVALUE
                     CACHE 1
                     );
             ALTER TABLE ONLY public.cities
                 ADD CONSTRAINT cities_pkey PRIMARY KEY (id);
             CREATE INDEX cities_country_id_idx ON public.cities USING btree (country_id);
             CREATE INDEX cities_state_id_idx ON public.cities USING btree (state_id);
             ALTER TABLE ONLY public.cities
                 ADD CONSTRAINT cities_country_id_fkey FOREIGN KEY (country_id) REFERENCES public.countries (id);
             ALTER TABLE ONLY public.cities
                 ADD CONSTRAINT cities_state_id_fkey FOREIGN KEY (state_id) REFERENCES public.states (id);"